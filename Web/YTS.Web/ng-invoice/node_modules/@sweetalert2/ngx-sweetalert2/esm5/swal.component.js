/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { ChangeDetectionStrategy, Component, EventEmitter, Inject, Input, Output } from '@angular/core';
import Swal from 'sweetalert2';
import { SwalDefaults } from './di';
/**
 * <swal> component. See the README.md for usage.
 *
 * It contains a bunch of \@Inputs that have a perfect 1:1 mapping with SweetAlert2 options.
 * Their types are directly coming from SweetAlert2 types defintitions, meaning that ngx-sweetalert2 is tightly coupled
 * to SweetAlert2, but also is type-safe.
 *
 * /!\ Some SweetAlert options aren't \@Inputs but \@Outputs: onBeforeOpen, onOpen, and onClose (without "on*" prefix).
 *     However, preConfirm and inputValidtor are still \@Inputs because there are not event handlers, there can't be
 *     multiple listeners and we need the Promise they must return.
 *
 * /!\ You can notice that the SweetAlert2 `useRejections` and `expectRejections` are the only one to not have
 *     an \@Input(). That's because they are deprecated and not using the default value of these parameters leads to
 *     clunky control flow. They are supported (use [options]="{}"), but please don't use them.
 */
var SwalComponent = /** @class */ (function () {
    function SwalComponent(defaultSwalOptions) {
        this.defaultSwalOptions = defaultSwalOptions;
        /**
         * Emits a BeforeOpenEvent when the modal DOM element has been created.
         * Useful to perform DOM mutations before the modal is shown.
         */
        this.beforeOpen = new EventEmitter();
        /**
         * Emits an OpenEvent when the modal is shown.
         */
        this.open = new EventEmitter();
        /**
         * Emits a CloseEvent when modal get closed.
         */
        this.close = new EventEmitter();
        /**
         * Emits when the user clicks "Confirm".
         * Bears a value when using "input", resolved "preConfirm", etc.
         *
         * Example:
         *     public handleConfirm(email: string): void {
         *         // ... save user email
         *     }
         */
        this.confirm = new EventEmitter();
        /**
         * Emits when the user clicks "Cancel" (or dismisses the modal by any other way).
         * By default, it will emit a string representing the reason for which the SweetAlert has been closed, or the
         * value of a rejected "preConfirm".
         *
         * Example:
         *     public handleCancel(reason: string): void {
         *         // reason can be 'cancel', 'overlay', 'close', and 'timer'
         *         // ... do something
         *     }
         */
        this.cancel = new EventEmitter();
        this.nativeSwal = Swal;
        this.isCurrentlyShown = false;
        this.touchedProps = new Set();
        this.markTouched = this.touchedProps.add.bind(this.touchedProps);
        //=> Force `this` scope of show() on this component
        //   Useful for doing things like (click)="mySwal.show()".
        this.show = this.show.bind(this);
    }
    Object.defineProperty(SwalComponent.prototype, "options", {
        get: /**
         * @return {?}
         */
        function () {
            var _this = this;
            /** @type {?} */
            var options = {};
            //=> We will compute the options object based on the option keys that are known to have changed.
            // That avoids passing a gigantic object to SweetAlert2, making debugging easier and potentially avoiding
            // side effects.
            this.touchedProps.forEach(function (prop) {
                options[prop] = ((/** @type {?} */ (_this)))[prop];
            });
            return options;
        },
        /**
         * An object of SweetAlert2 native options, useful if:
         *  - you don't want to use the @Inputs for practical/philosophical reasons ;
         *  - there are missing @Inputs because ngx-sweetalert2 isn't up-to-date with SweetAlert2's latest changes.
         *
         * /!\ Be aware that the options defined in this object will override the @Inputs of the same name.
         */
        set: /**
         * An object of SweetAlert2 native options, useful if:
         *  - you don't want to use the \@Inputs for practical/philosophical reasons ;
         *  - there are missing \@Inputs because ngx-sweetalert2 isn't up-to-date with SweetAlert2's latest changes.
         *
         * /!\ Be aware that the options defined in this object will override the \@Inputs of the same name.
         * @param {?} options
         * @return {?}
         */
        function (options) {
            Object.assign(this, options);
            Object.keys(options).forEach(this.markTouched);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} changes
     * @return {?}
     */
    SwalComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        Object.keys(changes)
            .filter(function (prop) { return prop !== 'options'; })
            .forEach(this.markTouched);
    };
    /**
     * @return {?}
     */
    SwalComponent.prototype.ngOnDestroy = /**
     * @return {?}
     */
    function () {
        if (this.isCurrentlyShown) {
            Swal.close();
        }
    };
    /**
     * Shows the SweetAlert.
     *
     * Returns the SweetAlert2 promise for convenience and use in code behind templates.
     * Otherwise, (confirm)="myHandler($event)" and (cancel)="myHandler($event)" can be used in templates.
     */
    /**
     * Shows the SweetAlert.
     *
     * Returns the SweetAlert2 promise for convenience and use in code behind templates.
     * Otherwise, (confirm)="myHandler($event)" and (cancel)="myHandler($event)" can be used in templates.
     * @return {?}
     */
    SwalComponent.prototype.show = /**
     * Shows the SweetAlert.
     *
     * Returns the SweetAlert2 promise for convenience and use in code behind templates.
     * Otherwise, (confirm)="myHandler($event)" and (cancel)="myHandler($event)" can be used in templates.
     * @return {?}
     */
    function () {
        var _this = this;
        //=> Build the SweetAlert2 options
        /** @type {?} */
        var options = tslib_1.__assign({}, this.defaultSwalOptions, this.options, { onBeforeOpen: function (modalElement) {
                _this.beforeOpen.emit({ modalElement: modalElement });
            }, onOpen: function (modalElement) {
                _this.isCurrentlyShown = true;
                _this.open.emit({ modalElement: modalElement });
            }, onClose: function (modalElement) {
                _this.isCurrentlyShown = false;
                _this.close.emit({ modalElement: modalElement });
            } });
        //=> Show the Swal!
        /** @type {?} */
        var promise = Swal.fire(options);
        //=> Handle (confirm) and (cancel) @Outputs
        // tslint:disable-next-line:no-string-literal
        /** @type {?} */
        var useRejections = ((/** @type {?} */ (options))).useRejections;
        promise.then(function (result) {
            if (useRejections) {
                _this.confirm.emit(result);
            }
            else if ('value' in result) {
                _this.confirm.emit(result.value);
            }
            else {
                _this.cancel.emit(result.dismiss);
            }
        }, function (err) {
            if (useRejections) {
                _this.cancel.emit(err);
            }
        });
        //=> Return the unaltered promise
        return promise;
    };
    SwalComponent.decorators = [
        { type: Component, args: [{
                    selector: 'swal',
                    template: '',
                    changeDetection: ChangeDetectionStrategy.OnPush
                }] }
    ];
    /** @nocollapse */
    SwalComponent.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: [SwalDefaults,] }] }
    ]; };
    SwalComponent.propDecorators = {
        title: [{ type: Input }],
        titleText: [{ type: Input }],
        text: [{ type: Input }],
        html: [{ type: Input }],
        footer: [{ type: Input }],
        type: [{ type: Input }],
        backdrop: [{ type: Input }],
        toast: [{ type: Input }],
        target: [{ type: Input }],
        input: [{ type: Input }],
        width: [{ type: Input }],
        padding: [{ type: Input }],
        background: [{ type: Input }],
        position: [{ type: Input }],
        grow: [{ type: Input }],
        customClass: [{ type: Input }],
        timer: [{ type: Input }],
        animation: [{ type: Input }],
        allowOutsideClick: [{ type: Input }],
        allowEscapeKey: [{ type: Input }],
        allowEnterKey: [{ type: Input }],
        showConfirmButton: [{ type: Input }],
        showCancelButton: [{ type: Input }],
        confirmButtonText: [{ type: Input }],
        cancelButtonText: [{ type: Input }],
        confirmButtonColor: [{ type: Input }],
        cancelButtonColor: [{ type: Input }],
        confirmButtonClass: [{ type: Input }],
        cancelButtonClass: [{ type: Input }],
        confirmButtonAriaLabel: [{ type: Input }],
        cancelButtonAriaLabel: [{ type: Input }],
        buttonsStyling: [{ type: Input }],
        reverseButtons: [{ type: Input }],
        focusConfirm: [{ type: Input }],
        focusCancel: [{ type: Input }],
        showCloseButton: [{ type: Input }],
        closeButtonAriaLabel: [{ type: Input }],
        showLoaderOnConfirm: [{ type: Input }],
        preConfirm: [{ type: Input }],
        imageUrl: [{ type: Input }],
        imageWidth: [{ type: Input }],
        imageHeight: [{ type: Input }],
        imageAlt: [{ type: Input }],
        imageClass: [{ type: Input }],
        inputPlaceholder: [{ type: Input }],
        inputValue: [{ type: Input }],
        inputOptions: [{ type: Input }],
        inputAutoTrim: [{ type: Input }],
        inputAttributes: [{ type: Input }],
        inputValidator: [{ type: Input }],
        inputClass: [{ type: Input }],
        progressSteps: [{ type: Input }],
        currentProgressStep: [{ type: Input }],
        progressStepsDistance: [{ type: Input }],
        beforeOpen: [{ type: Output }],
        open: [{ type: Output }],
        close: [{ type: Output }],
        confirm: [{ type: Output }],
        cancel: [{ type: Output }],
        options: [{ type: Input }]
    };
    return SwalComponent;
}());
export { SwalComponent };
if (false) {
    /** @type {?} */
    SwalComponent.prototype.title;
    /** @type {?} */
    SwalComponent.prototype.titleText;
    /** @type {?} */
    SwalComponent.prototype.text;
    /** @type {?} */
    SwalComponent.prototype.html;
    /** @type {?} */
    SwalComponent.prototype.footer;
    /** @type {?} */
    SwalComponent.prototype.type;
    /** @type {?} */
    SwalComponent.prototype.backdrop;
    /** @type {?} */
    SwalComponent.prototype.toast;
    /** @type {?} */
    SwalComponent.prototype.target;
    /** @type {?} */
    SwalComponent.prototype.input;
    /** @type {?} */
    SwalComponent.prototype.width;
    /** @type {?} */
    SwalComponent.prototype.padding;
    /** @type {?} */
    SwalComponent.prototype.background;
    /** @type {?} */
    SwalComponent.prototype.position;
    /** @type {?} */
    SwalComponent.prototype.grow;
    /** @type {?} */
    SwalComponent.prototype.customClass;
    /** @type {?} */
    SwalComponent.prototype.timer;
    /** @type {?} */
    SwalComponent.prototype.animation;
    /** @type {?} */
    SwalComponent.prototype.allowOutsideClick;
    /** @type {?} */
    SwalComponent.prototype.allowEscapeKey;
    /** @type {?} */
    SwalComponent.prototype.allowEnterKey;
    /** @type {?} */
    SwalComponent.prototype.showConfirmButton;
    /** @type {?} */
    SwalComponent.prototype.showCancelButton;
    /** @type {?} */
    SwalComponent.prototype.confirmButtonText;
    /** @type {?} */
    SwalComponent.prototype.cancelButtonText;
    /** @type {?} */
    SwalComponent.prototype.confirmButtonColor;
    /** @type {?} */
    SwalComponent.prototype.cancelButtonColor;
    /** @type {?} */
    SwalComponent.prototype.confirmButtonClass;
    /** @type {?} */
    SwalComponent.prototype.cancelButtonClass;
    /** @type {?} */
    SwalComponent.prototype.confirmButtonAriaLabel;
    /** @type {?} */
    SwalComponent.prototype.cancelButtonAriaLabel;
    /** @type {?} */
    SwalComponent.prototype.buttonsStyling;
    /** @type {?} */
    SwalComponent.prototype.reverseButtons;
    /** @type {?} */
    SwalComponent.prototype.focusConfirm;
    /** @type {?} */
    SwalComponent.prototype.focusCancel;
    /** @type {?} */
    SwalComponent.prototype.showCloseButton;
    /** @type {?} */
    SwalComponent.prototype.closeButtonAriaLabel;
    /** @type {?} */
    SwalComponent.prototype.showLoaderOnConfirm;
    /** @type {?} */
    SwalComponent.prototype.preConfirm;
    /** @type {?} */
    SwalComponent.prototype.imageUrl;
    /** @type {?} */
    SwalComponent.prototype.imageWidth;
    /** @type {?} */
    SwalComponent.prototype.imageHeight;
    /** @type {?} */
    SwalComponent.prototype.imageAlt;
    /** @type {?} */
    SwalComponent.prototype.imageClass;
    /** @type {?} */
    SwalComponent.prototype.inputPlaceholder;
    /** @type {?} */
    SwalComponent.prototype.inputValue;
    /** @type {?} */
    SwalComponent.prototype.inputOptions;
    /** @type {?} */
    SwalComponent.prototype.inputAutoTrim;
    /** @type {?} */
    SwalComponent.prototype.inputAttributes;
    /** @type {?} */
    SwalComponent.prototype.inputValidator;
    /** @type {?} */
    SwalComponent.prototype.inputClass;
    /** @type {?} */
    SwalComponent.prototype.progressSteps;
    /** @type {?} */
    SwalComponent.prototype.currentProgressStep;
    /** @type {?} */
    SwalComponent.prototype.progressStepsDistance;
    /**
     * Emits a BeforeOpenEvent when the modal DOM element has been created.
     * Useful to perform DOM mutations before the modal is shown.
     * @type {?}
     */
    SwalComponent.prototype.beforeOpen;
    /**
     * Emits an OpenEvent when the modal is shown.
     * @type {?}
     */
    SwalComponent.prototype.open;
    /**
     * Emits a CloseEvent when modal get closed.
     * @type {?}
     */
    SwalComponent.prototype.close;
    /**
     * Emits when the user clicks "Confirm".
     * Bears a value when using "input", resolved "preConfirm", etc.
     *
     * Example:
     *     public handleConfirm(email: string): void {
     *         // ... save user email
     *     }
     * @type {?}
     */
    SwalComponent.prototype.confirm;
    /**
     * Emits when the user clicks "Cancel" (or dismisses the modal by any other way).
     * By default, it will emit a string representing the reason for which the SweetAlert has been closed, or the
     * value of a rejected "preConfirm".
     *
     * Example:
     *     public handleCancel(reason: string): void {
     *         // reason can be 'cancel', 'overlay', 'close', and 'timer'
     *         // ... do something
     *     }
     * @type {?}
     */
    SwalComponent.prototype.cancel;
    /** @type {?} */
    SwalComponent.prototype.nativeSwal;
    /** @type {?} */
    SwalComponent.prototype.isCurrentlyShown;
    /** @type {?} */
    SwalComponent.prototype.touchedProps;
    /** @type {?} */
    SwalComponent.prototype.markTouched;
    /** @type {?} */
    SwalComponent.prototype.defaultSwalOptions;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3dhbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac3dlZXRhbGVydDIvbmd4LXN3ZWV0YWxlcnQyLyIsInNvdXJjZXMiOlsic3dhbC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQ0gsdUJBQXVCLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUF3QixNQUFNLEVBQ2hHLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sSUFBMkIsTUFBTSxhQUFhLENBQUM7QUFDdEQsT0FBTyxFQUFFLFlBQVksRUFBRSxNQUFNLE1BQU0sQ0FBQzs7Ozs7Ozs7Ozs7Ozs7OztBQWtCcEM7SUF3SUksdUJBQTBELGtCQUFxQztRQUFyQyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQW1COzs7OztRQXJFckUsZUFBVSxHQUFHLElBQUksWUFBWSxFQUEwQixDQUFDOzs7O1FBS3hELFNBQUksR0FBRyxJQUFJLFlBQVksRUFBb0IsQ0FBQzs7OztRQUs1QyxVQUFLLEdBQUcsSUFBSSxZQUFZLEVBQXFCLENBQUM7Ozs7Ozs7Ozs7UUFXOUMsWUFBTyxHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7Ozs7Ozs7Ozs7OztRQWFsQyxXQUFNLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQTJCcEQsZUFBVSxHQUFHLElBQUksQ0FBQztRQUVqQixxQkFBZ0IsR0FBRyxLQUFLLENBQUM7UUFFaEIsaUJBQVksR0FBRyxJQUFJLEdBQUcsRUFBMkIsQ0FBQztRQUVsRCxnQkFBVyxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7UUFHekUsbURBQW1EO1FBQ25ELDBEQUEwRDtRQUMxRCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUE5QkQsc0JBQW9C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YW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5qZWN0LCBJbnB1dCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3ksIE91dHB1dCwgU2ltcGxlQ2hhbmdlc1xufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCBTd2FsLCB7IFN3ZWV0QWxlcnRPcHRpb25zIH0gZnJvbSAnc3dlZXRhbGVydDInO1xuaW1wb3J0IHsgU3dhbERlZmF1bHRzIH0gZnJvbSAnLi9kaSc7XG5pbXBvcnQgKiBhcyBldmVudHMgZnJvbSAnLi9zd2FsLWV2ZW50cyc7XG5cbi8qKlxuICogPHN3YWw+IGNvbXBvbmVudC4gU2VlIHRoZSBSRUFETUUubWQgZm9yIHVzYWdlLlxuICpcbiAqIEl0IGNvbnRhaW5zIGEgYnVuY2ggb2YgQElucHV0cyB0aGF0IGhhdmUgYSBwZXJmZWN0IDE6MSBtYXBwaW5nIHdpdGggU3dlZXRBbGVydDIgb3B0aW9ucy5cbiAqIFRoZWlyIHR5cGVzIGFyZSBkaXJlY3RseSBjb21pbmcgZnJvbSBTd2VldEFsZXJ0MiB0eXBlcyBkZWZpbnRpdGlvbnMsIG1lYW5pbmcgdGhhdCBuZ3gtc3dlZXRhbGVydDIgaXMgdGlnaHRseSBjb3VwbGVkXG4gKiB0byBTd2VldEFsZXJ0MiwgYnV0IGFsc28gaXMgdHlwZS1zYWZlLlxuICpcbiAqIC8hXFwgU29tZSBTd2VldEFsZXJ0IG9wdGlvbnMgYXJlbid0IEBJbnB1dHMgYnV0IEBPdXRwdXRzOiBvbkJlZm9yZU9wZW4sIG9uT3BlbiwgYW5kIG9uQ2xvc2UgKHdpdGhvdXQgXCJvbipcIiBwcmVmaXgpLlxuICogICAgIEhvd2V2ZXIsIHByZUNvbmZpcm0gYW5kIGlucHV0VmFsaWR0b3IgYXJlIHN0aWxsIEBJbnB1dHMgYmVjYXVzZSB0aGVyZSBhcmUgbm90IGV2ZW50IGhhbmRsZXJzLCB0aGVyZSBjYW4ndCBiZVxuICogICAgIG11bHRpcGxlIGxpc3RlbmVycyBhbmQgd2UgbmVlZCB0aGUgUHJvbWlzZSB0aGV5IG11c3QgcmV0dXJuLlxuICpcbiAqIC8hXFwgWW91IGNhbiBub3RpY2UgdGhhdCB0aGUgU3dlZXRBbGVydDIgYHVzZVJlamVjdGlvbnNgIGFuZCBgZXhwZWN0UmVqZWN0aW9uc2AgYXJlIHRoZSBvbmx5IG9uZSB0byBub3QgaGF2ZVxuICogICAgIGFuIEBJbnB1dCgpLiBUaGF0J3MgYmVjYXVzZSB0aGV5IGFyZSBkZXByZWNhdGVkIGFuZCBub3QgdXNpbmcgdGhlIGRlZmF1bHQgdmFsdWUgb2YgdGhlc2UgcGFyYW1ldGVycyBsZWFkcyB0b1xuICogICAgIGNsdW5reSBjb250cm9sIGZsb3cuIFRoZXkgYXJlIHN1cHBvcnRlZCAodXNlIFtvcHRpb25zXT1cInt9XCIpLCBidXQgcGxlYXNlIGRvbid0IHVzZSB0aGVtLlxuICovXG5AQ29tcG9uZW50KHtcbiAgICBzZWxlY3RvcjogJ3N3YWwnLFxuICAgIHRlbXBsYXRlOiAnJyxcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaFxufSlcbmV4cG9ydCBjbGFzcyBTd2FsQ29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzLCBPbkRlc3Ryb3kge1xuICAgIC8vIElmIFN3YWwgZ2V0cyBtb3JlIHRoYW4gYSBodW5kcmVkIHByb3BzLCBJJ2xsIHdyaXRlIGEgY29kZSBnZW5lcmF0b3IsIEkgcHJvbWlzZS5cbiAgICAvLyBBbmQgSSBhbHdheXMgcmVzb2x2ZSgpIG15IHByb21pc2VzLlxuICAgIEBJbnB1dCgpIHB1YmxpYyB0aXRsZTogU3dlZXRBbGVydE9wdGlvbnNbJ3RpdGxlJ107XG4gICAgQElucHV0KCkgcHVibGljIHRpdGxlVGV4dDogU3dlZXRBbGVydE9wdGlvbnNbJ3RpdGxlVGV4dCddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyB0ZXh0OiBTd2VldEFsZXJ0T3B0aW9uc1sndGV4dCddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBodG1sOiBTd2VldEFsZXJ0T3B0aW9uc1snaHRtbCddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBmb290ZXI6IFN3ZWV0QWxlcnRPcHRpb25zWydmb290ZXInXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgdHlwZTogU3dlZXRBbGVydE9wdGlvbnNbJ3R5cGUnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgYmFja2Ryb3A6IFN3ZWV0QWxlcnRPcHRpb25zWydiYWNrZHJvcCddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyB0b2FzdDogU3dlZXRBbGVydE9wdGlvbnNbJ3RvYXN0J107XG4gICAgQElucHV0KCkgcHVibGljIHRhcmdldDogU3dlZXRBbGVydE9wdGlvbnNbJ3RhcmdldCddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBpbnB1dDogU3dlZXRBbGVydE9wdGlvbnNbJ2lucHV0J107XG4gICAgQElucHV0KCkgcHVibGljIHdpZHRoOiBTd2VldEFsZXJ0T3B0aW9uc1snd2lkdGgnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgcGFkZGluZzogU3dlZXRBbGVydE9wdGlvbnNbJ3BhZGRpbmcnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgYmFja2dyb3VuZDogU3dlZXRBbGVydE9wdGlvbnNbJ2JhY2tncm91bmQnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgcG9zaXRpb246IFN3ZWV0QWxlcnRPcHRpb25zWydwb3NpdGlvbiddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBncm93OiBTd2VldEFsZXJ0T3B0aW9uc1snZ3JvdyddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBjdXN0b21DbGFzczogU3dlZXRBbGVydE9wdGlvbnNbJ2N1c3RvbUNsYXNzJ107XG4gICAgQElucHV0KCkgcHVibGljIHRpbWVyOiBTd2VldEFsZXJ0T3B0aW9uc1sndGltZXInXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgYW5pbWF0aW9uOiBTd2VldEFsZXJ0T3B0aW9uc1snYW5pbWF0aW9uJ107XG4gICAgQElucHV0KCkgcHVibGljIGFsbG93T3V0c2lkZUNsaWNrOiBTd2VldEFsZXJ0T3B0aW9uc1snYWxsb3dPdXRzaWRlQ2xpY2snXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgYWxsb3dFc2NhcGVLZXk6IFN3ZWV0QWxlcnRPcHRpb25zWydhbGxvd0VzY2FwZUtleSddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBhbGxvd0VudGVyS2V5OiBTd2VldEFsZXJ0T3B0aW9uc1snYWxsb3dFbnRlcktleSddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBzaG93Q29uZmlybUJ1dHRvbjogU3dlZXRBbGVydE9wdGlvbnNbJ3Nob3dDb25maXJtQnV0dG9uJ107XG4gICAgQElucHV0KCkgcHVibGljIHNob3dDYW5jZWxCdXR0b246IFN3ZWV0QWxlcnRPcHRpb25zWydzaG93Q2FuY2VsQnV0dG9uJ107XG4gICAgQElucHV0KCkgcHVibGljIGNvbmZpcm1CdXR0b25UZXh0OiBTd2VldEFsZXJ0T3B0aW9uc1snY29uZmlybUJ1dHRvblRleHQnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgY2FuY2VsQnV0dG9uVGV4dDogU3dlZXRBbGVydE9wdGlvbnNbJ2NhbmNlbEJ1dHRvblRleHQnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgY29uZmlybUJ1dHRvbkNvbG9yOiBTd2VldEFsZXJ0T3B0aW9uc1snY29uZmlybUJ1dHRvbkNvbG9yJ107XG4gICAgQElucHV0KCkgcHVibGljIGNhbmNlbEJ1dHRvbkNvbG9yOiBTd2VldEFsZXJ0T3B0aW9uc1snY2FuY2VsQnV0dG9uQ29sb3InXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgY29uZmlybUJ1dHRvbkNsYXNzOiBTd2VldEFsZXJ0T3B0aW9uc1snY29uZmlybUJ1dHRvbkNsYXNzJ107XG4gICAgQElucHV0KCkgcHVibGljIGNhbmNlbEJ1dHRvbkNsYXNzOiBTd2VldEFsZXJ0T3B0aW9uc1snY2FuY2VsQnV0dG9uQ2xhc3MnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgY29uZmlybUJ1dHRvbkFyaWFMYWJlbDogU3dlZXRBbGVydE9wdGlvbnNbJ2NvbmZpcm1CdXR0b25BcmlhTGFiZWwnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgY2FuY2VsQnV0dG9uQXJpYUxhYmVsOiBTd2VldEFsZXJ0T3B0aW9uc1snY2FuY2VsQnV0dG9uQXJpYUxhYmVsJ107XG4gICAgQElucHV0KCkgcHVibGljIGJ1dHRvbnNTdHlsaW5nOiBTd2VldEFsZXJ0T3B0aW9uc1snYnV0dG9uc1N0eWxpbmcnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgcmV2ZXJzZUJ1dHRvbnM6IFN3ZWV0QWxlcnRPcHRpb25zWydyZXZlcnNlQnV0dG9ucyddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBmb2N1c0NvbmZpcm06IFN3ZWV0QWxlcnRPcHRpb25zWydmb2N1c0NvbmZpcm0nXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgZm9jdXNDYW5jZWw6IFN3ZWV0QWxlcnRPcHRpb25zWydmb2N1c0NhbmNlbCddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBzaG93Q2xvc2VCdXR0b246IFN3ZWV0QWxlcnRPcHRpb25zWydzaG93Q2xvc2VCdXR0b24nXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgY2xvc2VCdXR0b25BcmlhTGFiZWw6IFN3ZWV0QWxlcnRPcHRpb25zWydjbG9zZUJ1dHRvbkFyaWFMYWJlbCddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBzaG93TG9hZGVyT25Db25maXJtOiBTd2VldEFsZXJ0T3B0aW9uc1snc2hvd0xvYWRlck9uQ29uZmlybSddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBwcmVDb25maXJtOiBTd2VldEFsZXJ0T3B0aW9uc1sncHJlQ29uZmlybSddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBpbWFnZVVybDogU3dlZXRBbGVydE9wdGlvbnNbJ2ltYWdlVXJsJ107XG4gICAgQElucHV0KCkgcHVibGljIGltYWdlV2lkdGg6IFN3ZWV0QWxlcnRPcHRpb25zWydpbWFnZVdpZHRoJ107XG4gICAgQElucHV0KCkgcHVibGljIGltYWdlSGVpZ2h0OiBTd2VldEFsZXJ0T3B0aW9uc1snaW1hZ2VIZWlnaHQnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgaW1hZ2VBbHQ6IFN3ZWV0QWxlcnRPcHRpb25zWydpbWFnZUFsdCddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBpbWFnZUNsYXNzOiBTd2VldEFsZXJ0T3B0aW9uc1snaW1hZ2VDbGFzcyddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBpbnB1dFBsYWNlaG9sZGVyOiBTd2VldEFsZXJ0T3B0aW9uc1snaW5wdXRQbGFjZWhvbGRlciddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBpbnB1dFZhbHVlOiBTd2VldEFsZXJ0T3B0aW9uc1snaW5wdXRWYWx1ZSddO1xuICAgIEBJbnB1dCgpIHB1YmxpYyBpbnB1dE9wdGlvbnM6IFN3ZWV0QWxlcnRPcHRpb25zWydpbnB1dE9wdGlvbnMnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgaW5wdXRBdXRvVHJpbTogU3dlZXRBbGVydE9wdGlvbnNbJ2lucHV0QXV0b1RyaW0nXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgaW5wdXRBdHRyaWJ1dGVzOiBTd2VldEFsZXJ0T3B0aW9uc1snaW5wdXRBdHRyaWJ1dGVzJ107XG4gICAgQElucHV0KCkgcHVibGljIGlucHV0VmFsaWRhdG9yOiBTd2VldEFsZXJ0T3B0aW9uc1snaW5wdXRWYWxpZGF0b3InXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgaW5wdXRDbGFzczogU3dlZXRBbGVydE9wdGlvbnNbJ2lucHV0Q2xhc3MnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgcHJvZ3Jlc3NTdGVwczogU3dlZXRBbGVydE9wdGlvbnNbJ3Byb2dyZXNzU3RlcHMnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgY3VycmVudFByb2dyZXNzU3RlcDogU3dlZXRBbGVydE9wdGlvbnNbJ2N1cnJlbnRQcm9ncmVzc1N0ZXAnXTtcbiAgICBASW5wdXQoKSBwdWJsaWMgcHJvZ3Jlc3NTdGVwc0Rpc3RhbmNlOiBTd2VldEFsZXJ0T3B0aW9uc1sncHJvZ3Jlc3NTdGVwc0Rpc3RhbmNlJ107XG5cbiAgICAvKipcbiAgICAgKiBFbWl0cyBhIEJlZm9yZU9wZW5FdmVudCB3aGVuIHRoZSBtb2RhbCBET00gZWxlbWVudCBoYXMgYmVlbiBjcmVhdGVkLlxuICAgICAqIFVzZWZ1bCB0byBwZXJmb3JtIERPTSBtdXRhdGlvbnMgYmVmb3JlIHRoZSBtb2RhbCBpcyBzaG93bi5cbiAgICAgKi9cbiAgICBAT3V0cHV0KCkgcHVibGljIHJlYWRvbmx5IGJlZm9yZU9wZW4gPSBuZXcgRXZlbnRFbWl0dGVyPGV2ZW50cy5CZWZvcmVPcGVuRXZlbnQ+KCk7XG5cbiAgICAvKipcbiAgICAgKiBFbWl0cyBhbiBPcGVuRXZlbnQgd2hlbiB0aGUgbW9kYWwgaXMgc2hvd24uXG4gICAgICovXG4gICAgQE91dHB1dCgpIHB1YmxpYyByZWFkb25seSBvcGVuID0gbmV3IEV2ZW50RW1pdHRlcjxldmVudHMuT3BlbkV2ZW50PigpO1xuXG4gICAgLyoqXG4gICAgICogRW1pdHMgYSBDbG9zZUV2ZW50IHdoZW4gbW9kYWwgZ2V0IGNsb3NlZC5cbiAgICAgKi9cbiAgICBAT3V0cHV0KCkgcHVibGljIHJlYWRvbmx5IGNsb3NlID0gbmV3IEV2ZW50RW1pdHRlcjxldmVudHMuQ2xvc2VFdmVudD4oKTtcblxuICAgIC8qKlxuICAgICAqIEVtaXRzIHdoZW4gdGhlIHVzZXIgY2xpY2tzIFwiQ29uZmlybVwiLlxuICAgICAqIEJlYXJzIGEgdmFsdWUgd2hlbiB1c2luZyBcImlucHV0XCIsIHJlc29sdmVkIFwicHJlQ29uZmlybVwiLCBldGMuXG4gICAgICpcbiAgICAgKiBFeGFtcGxlOlxuICAgICAqICAgICBwdWJsaWMgaGFuZGxlQ29uZmlybShlbWFpbDogc3RyaW5nKTogdm9pZCB7XG4gICAgICogICAgICAgICAvLyAuLi4gc2F2ZSB1c2VyIGVtYWlsXG4gICAgICogICAgIH1cbiAgICAgKi9cbiAgICBAT3V0cHV0KCkgcHVibGljIHJlYWRvbmx5IGNvbmZpcm0gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAgIC8qKlxuICAgICAqIEVtaXRzIHdoZW4gdGhlIHVzZXIgY2xpY2tzIFwiQ2FuY2VsXCIgKG9yIGRpc21pc3NlcyB0aGUgbW9kYWwgYnkgYW55IG90aGVyIHdheSkuXG4gICAgICogQnkgZGVmYXVsdCwgaXQgd2lsbCBlbWl0IGEgc3RyaW5nIHJlcHJlc2VudGluZyB0aGUgcmVhc29uIGZvciB3aGljaCB0aGUgU3dlZXRBbGVydCBoYXMgYmVlbiBjbG9zZWQsIG9yIHRoZVxuICAgICAqIHZhbHVlIG9mIGEgcmVqZWN0ZWQgXCJwcmVDb25maXJtXCIuXG4gICAgICpcbiAgICAgKiBFeGFtcGxlOlxuICAgICAqICAgICBwdWJsaWMgaGFuZGxlQ2FuY2VsKHJlYXNvbjogc3RyaW5nKTogdm9pZCB7XG4gICAgICogICAgICAgICAvLyByZWFzb24gY2FuIGJlICdjYW5jZWwnLCAnb3ZlcmxheScsICdjbG9zZScsIGFuZCAndGltZXInXG4gICAgICogICAgICAgICAvLyAuLi4gZG8gc29tZXRoaW5nXG4gICAgICogICAgIH1cbiAgICAgKi9cbiAgICBAT3V0cHV0KCkgcHVibGljIHJlYWRvbmx5IGNhbmNlbCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuXG4gICAgLyoqXG4gICAgICogQW4gb2JqZWN0IG9mIFN3ZWV0QWxlcnQyIG5hdGl2ZSBvcHRpb25zLCB1c2VmdWwgaWY6XG4gICAgICogIC0geW91IGRvbid0IHdhbnQgdG8gdXNlIHRoZSBASW5wdXRzIGZvciBwcmFjdGljYWwvcGhpbG9zb3BoaWNhbCByZWFzb25zIDtcbiAgICAgKiAgLSB0aGVyZSBhcmUgbWlzc2luZyBASW5wdXRzIGJlY2F1c2Ugbmd4LXN3ZWV0YWxlcnQyIGlzbid0IHVwLXRvLWRhdGUgd2l0aCBTd2VldEFsZXJ0MidzIGxhdGVzdCBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogLyFcXCBCZSBhd2FyZSB0aGF0IHRoZSBvcHRpb25zIGRlZmluZWQgaW4gdGhpcyBvYmplY3Qgd2lsbCBvdmVycmlkZSB0aGUgQElucHV0cyBvZiB0aGUgc2FtZSBuYW1lLlxuICAgICAqL1xuICAgIEBJbnB1dCgpIHB1YmxpYyBzZXQgb3B0aW9ucyhvcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucykge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICBPYmplY3Qua2V5cyhvcHRpb25zKS5mb3JFYWNoKHRoaXMubWFya1RvdWNoZWQpO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQgb3B0aW9ucygpOiBTd2VldEFsZXJ0T3B0aW9ucyB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnM6IFN3ZWV0QWxlcnRPcHRpb25zID0ge307XG5cbiAgICAgICAgLy89PiBXZSB3aWxsIGNvbXB1dGUgdGhlIG9wdGlvbnMgb2JqZWN0IGJhc2VkIG9uIHRoZSBvcHRpb24ga2V5cyB0aGF0IGFyZSBrbm93biB0byBoYXZlIGNoYW5nZWQuXG4gICAgICAgIC8vIFRoYXQgYXZvaWRzIHBhc3NpbmcgYSBnaWdhbnRpYyBvYmplY3QgdG8gU3dlZXRBbGVydDIsIG1ha2luZyBkZWJ1Z2dpbmcgZWFzaWVyIGFuZCBwb3RlbnRpYWxseSBhdm9pZGluZ1xuICAgICAgICAvLyBzaWRlIGVmZmVjdHMuXG4gICAgICAgIHRoaXMudG91Y2hlZFByb3BzLmZvckVhY2gocHJvcCA9PiB7XG4gICAgICAgICAgICBvcHRpb25zW3Byb3BdID0gKHRoaXMgYXMgeyBbcHJvcDogc3RyaW5nXTogYW55IH0pW3Byb3BdO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gb3B0aW9ucztcbiAgICB9XG5cbiAgICBwdWJsaWMgbmF0aXZlU3dhbCA9IFN3YWw7XG5cbiAgICBwcml2YXRlIGlzQ3VycmVudGx5U2hvd24gPSBmYWxzZTtcblxuICAgIHByaXZhdGUgcmVhZG9ubHkgdG91Y2hlZFByb3BzID0gbmV3IFNldDxrZXlvZiBTd2VldEFsZXJ0T3B0aW9ucz4oKTtcblxuICAgIHByaXZhdGUgcmVhZG9ubHkgbWFya1RvdWNoZWQgPSB0aGlzLnRvdWNoZWRQcm9wcy5hZGQuYmluZCh0aGlzLnRvdWNoZWRQcm9wcyk7XG5cbiAgICBwdWJsaWMgY29uc3RydWN0b3IoQEluamVjdChTd2FsRGVmYXVsdHMpIHByaXZhdGUgcmVhZG9ubHkgZGVmYXVsdFN3YWxPcHRpb25zOiBTd2VldEFsZXJ0T3B0aW9ucykge1xuICAgICAgICAvLz0+IEZvcmNlIGB0aGlzYCBzY29wZSBvZiBzaG93KCkgb24gdGhpcyBjb21wb25lbnRcbiAgICAgICAgLy8gICBVc2VmdWwgZm9yIGRvaW5nIHRoaW5ncyBsaWtlIChjbGljayk9XCJteVN3YWwuc2hvdygpXCIuXG4gICAgICAgIHRoaXMuc2hvdyA9IHRoaXMuc2hvdy5iaW5kKHRoaXMpO1xuICAgIH1cblxuICAgIHB1YmxpYyBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgICAgIE9iamVjdC5rZXlzKGNoYW5nZXMpXG4gICAgICAgICAgICAuZmlsdGVyKHByb3AgPT4gcHJvcCAhPT0gJ29wdGlvbnMnKVxuICAgICAgICAgICAgLmZvckVhY2godGhpcy5tYXJrVG91Y2hlZCk7XG4gICAgfVxuXG4gICAgcHVibGljIG5nT25EZXN0cm95KCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5pc0N1cnJlbnRseVNob3duKSB7XG4gICAgICAgICAgICBTd2FsLmNsb3NlKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTaG93cyB0aGUgU3dlZXRBbGVydC5cbiAgICAgKlxuICAgICAqIFJldHVybnMgdGhlIFN3ZWV0QWxlcnQyIHByb21pc2UgZm9yIGNvbnZlbmllbmNlIGFuZCB1c2UgaW4gY29kZSBiZWhpbmQgdGVtcGxhdGVzLlxuICAgICAqIE90aGVyd2lzZSwgKGNvbmZpcm0pPVwibXlIYW5kbGVyKCRldmVudClcIiBhbmQgKGNhbmNlbCk9XCJteUhhbmRsZXIoJGV2ZW50KVwiIGNhbiBiZSB1c2VkIGluIHRlbXBsYXRlcy5cbiAgICAgKi9cbiAgICBwdWJsaWMgc2hvdygpOiBQcm9taXNlPGFueT4ge1xuICAgICAgICAvLz0+IEJ1aWxkIHRoZSBTd2VldEFsZXJ0MiBvcHRpb25zXG4gICAgICAgIGNvbnN0IG9wdGlvbnM6IFN3ZWV0QWxlcnRPcHRpb25zID0ge1xuICAgICAgICAgICAgLy89PiBNZXJnZSB3aXRoIHRoZSBkZWZhdWx0IG1vZHVsZS1sZXZlbCBvcHRpb25zXG4gICAgICAgICAgICAuLi50aGlzLmRlZmF1bHRTd2FsT3B0aW9ucyxcblxuICAgICAgICAgICAgLy89PiBNZXJnZSB3aXRoIGNhbGN1bGF0ZWQgb3B0aW9ucyBzZXQgZm9yIHRoYXQgc3BlY2lmaWMgc3dhbFxuICAgICAgICAgICAgLi4udGhpcy5vcHRpb25zLFxuXG4gICAgICAgICAgICAvLz0+IEhhbmRsZSBtb2RhbCBsaWZlY3ljbGUgZXZlbnRzXG4gICAgICAgICAgICBvbkJlZm9yZU9wZW46IChtb2RhbEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmJlZm9yZU9wZW4uZW1pdCh7IG1vZGFsRWxlbWVudCB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIG9uT3BlbjogKG1vZGFsRWxlbWVudCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuaXNDdXJyZW50bHlTaG93biA9IHRydWU7XG4gICAgICAgICAgICAgICAgdGhpcy5vcGVuLmVtaXQoeyBtb2RhbEVsZW1lbnQgfSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBvbkNsb3NlOiAobW9kYWxFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pc0N1cnJlbnRseVNob3duID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZS5lbWl0KHsgbW9kYWxFbGVtZW50IH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vPT4gU2hvdyB0aGUgU3dhbCFcbiAgICAgICAgY29uc3QgcHJvbWlzZSA9IFN3YWwuZmlyZShvcHRpb25zKTtcblxuICAgICAgICAvLz0+IEhhbmRsZSAoY29uZmlybSkgYW5kIChjYW5jZWwpIEBPdXRwdXRzXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1zdHJpbmctbGl0ZXJhbFxuICAgICAgICBjb25zdCB1c2VSZWplY3Rpb25zID0gKG9wdGlvbnMgYXMgeyB1c2VSZWplY3Rpb25zPzogYm9vbGVhbiB9KS51c2VSZWplY3Rpb25zO1xuXG4gICAgICAgIHByb21pc2UudGhlbihcbiAgICAgICAgICAgIHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHVzZVJlamVjdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb25maXJtLmVtaXQocmVzdWx0KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCd2YWx1ZScgaW4gcmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29uZmlybS5lbWl0KHJlc3VsdC52YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW5jZWwuZW1pdChyZXN1bHQuZGlzbWlzcyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVyciA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHVzZVJlamVjdGlvbnMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW5jZWwuZW1pdChlcnIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICAvLz0+IFJldHVybiB0aGUgdW5hbHRlcmVkIHByb21pc2VcbiAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfVxufVxuIl19